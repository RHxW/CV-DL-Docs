# HLA-Face

## 1. 问题背景
极端光照场景下的物体检测较为困难，人脸作为通用物体检测的一个方向同样存在这种问题。因此本文主要针对低光照场景下的人脸检测效果较差、检出率低的问题提出一套完整的数据增强和域适应框架，用于帮助现有检测模型实现更好的跨域泛化效果。

## 2. 问题分析
低光照场景下人脸检测所面临的最主要问题是正常光照和低光照场景下训练数据存在的domain gap，它的存在令使用正常光照数据训练得到的检测器难以泛化到低光照数据，因此在低光照场景下的检测效果较差。

## 3. 解决办法
针对数据中存在的domain gap，可以对数据进行增强，但是由于差异过大，现有的增强方法的效果都不理想，也就无法得到更好的检测效果。

本文针对这个较大的domain gap提出双向增强的方法；传统方法通常采用L->H的增强方式，本文采用L->E(L)和D(H)<-H的增强方式，也就是对低光照图片L做一些增强E同时对正常光照图片H做一些降质D，缩小了增强数据间差异，提升了增强的效果。

本文提出的增强框架可以分为低级和高级两部分，分别对应像素级和特征级。

### 3.1 低级匹配（像素级）
低级匹配关注于像素级别上的差异，例如亮度、色彩、噪声等。

低级匹配的数据增强所面临的问题和解决方案：

1. **如何对低光照图片进行增强E(L)？** 采用Zero-DCE算法进行光照增强
2. **如何进行噪声生成？** 采用自监督方式（加噪音）训练一个生成器用于加/去噪声
3. **如何进行图片降质D(H)？** 颜色失真的参数基于统计分析

### 3.2 高级匹配（特征级）
高级匹配关注于减小特征层面上的差异，提高检测器的泛化性能。高级匹配关注的问题及解决办法：

1. **如何缩小E(L)和H间差异？** 采用传统自监督方法（拼图法）保持跨域语义一致性
2. **如何缩小D(H)和H间差异？** 引入对抗学习的目标函数，构建正负样本对来缩减跨域语义特征差距
3. **利用E(L)来提升效果** 在E(L)上使用对抗学习的目标函数可以提升效果

## 4. 个人观点
本文提出一个完整的数据增强+模型微调流程框架，主要创新在于针对人脸图片的光照差异进行了单独的设计优化，在框架中引入多种增强方法，目标通过缩小domain gap从而提升模型微调训练效果，最终达到检测能力的提升。而且该框架利用自监督学习，在不需要目标域的标注数据的情况下即可实现性能提升。

但是由于暗光人脸的质量太差（包含的有效信息太少），一般不适用于人脸识别任务（识别模型对于它们的判别能力很差），所以这个框架也许在通用物体检测上的价值更高。
