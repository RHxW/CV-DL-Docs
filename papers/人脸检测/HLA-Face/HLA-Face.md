# HLA Face
## Abstract
大多数现有的人脸检测器严重依赖于大量标注数据，为了减轻构建低光照场景数据的负担，提出利用现有的正常光照数据并探索如何让正常光照的人脸检测器适应低光照场景。这个任务最大的挑战是正常光照和低光照场景间的无论在像素级别上还是目标级别上都存在的巨大domain gap.为了解决这一问题，提出一个联合High-Low Adaption(HLA)框架。通过一个双向低级适应和一个多任务高级适应方式能够达到sota性能，甚至不需要使用dark face标签进行训练。

## 1. Introduction
为了适应正常光照到低光照的变化，提出一个High-Low Adaptation 人脸检测框架(HLA-Face).考虑将低级和高级匹配(adaption)联合在一起。具体来说，对于低层级匹配，典型的方法是将暗图片变亮或者将亮图片变暗。但是由于存在巨大的domain gap，这些方法无法达到令人满意的效果。与这些单方向方法不同，我们采用双向的方法，使两个domain都进行变化，向彼此靠拢。通过增强暗图片的亮度和将正常光照图片失真的操作，构建两个domain间的中间状态。对于高层级匹配，采用多任务自监督学习以减少与低层级构建的中间状态特征的距离。通过结合高低层级匹配得到了sota的检测效果。主要贡献如下：
* 提出一个不需要暗场景数据标注的黑暗人脸检测框架
* 为低层级匹配设计了一个双向模式。
* 为高层级匹配引入了跨域自监督学习

## 2. Related Work

![Figure 2](2.png 'Figure 2')

## 3. Joint Adaptation for Dark Face Detection
![Figure 3](3.png 'Figure 3')
### 3.1. Motivation
目标是使在正常光照数据H上训练的人脸检测器泛化到低光照数据L上。如Figure 2所示，当前的方法可以大概分为3类：增强法，暗化法以及特征适应法。
基于**增强**的方法会亮化低光照图片并直接在上面进行测试，通常不需要模型微调，因此很灵活。
基于**暗化**的方法首先对正常光照的图片进行暗化，然后用这些暗化后的图片再对模型进行训练。增强方法和暗化方法都是像素级的方法。
**特征适应**方法一般采用对齐、对抗学习或者伪标签等手段直接适应模型特征。

暗光人脸检测的问题在于H和L间的domain gap非常大，而且对于现有的方法过于复杂。如Figure 3所示，WIDER FACE和DARK FACE的图片见不仅存在像素级的差异而且其内容也有很大不同。
然而增强和暗化方法仅考虑了像素级别的差异。特征适应方法则尝试在一步操作中填补这种gap

为了同时解决黑暗人脸检测的像素级和特征级的gap，提出一个高低匹配方法。如Figure 2(e)所示，设置好低层级上L和H的中间状态，然后根据这些状态对高层级表示进行匹配。与H-to-L或者L-to-H的单向变换相比，我们采用的双向变换：L-to-E(L)和H-to-D(H)不仅能够降低匹配的难度，也可以提供特征级别匹配的工具。高层级上距离的减小是通过将多状态的特征空间相互靠近实现的。

框架的细节如Figure 4所示。

### 3.2. Bidirectional Low-Level Adaptation
低层级匹配的困难主要有两方面：
1. 与高层级gap的联系
2. 低光照增强本身的困难，当前的低光照增强方法主要是为了人类视觉设计的而非机器视觉，当前的去噪和色彩重建方法对一些极端情况不够鲁棒。
![Figure 4](4.png 'Figure 4')

为了解决这些问题提出了双向低级匹配方法。低光照降质是一个复杂的过程。可以粗略地分解成三个方面：光照、噪音和色彩偏置。虽然去噪声和色彩纠正比较困难，但是反过来去加噪声和加色彩偏差相对容易。