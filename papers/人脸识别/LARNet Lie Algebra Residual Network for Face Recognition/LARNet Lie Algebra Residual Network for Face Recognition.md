# LARNet Lie Algebra Residual Network for Face Recognition
## Abstract
本文提出一个基于李代数的新方法，探索了人脸在3D空间的旋转如何影响CNN生成的特征。证明了人脸在图片空间的旋转等同于CNN在特征空间的一个额外的残差部分，该部分仅受旋转的影响。基于理论分析提出了LARNet(Lie Algebraic Residual Network)用于解决跨姿态人脸识别问题，LARNet的构成：
1. 一个用于从输入图片中解码旋转信息的残差子网络
2. 一个通过学习旋转量级来控制残差部分对特征学习贡献强度的门控子网络
![Figure 1](1.png 'Figure 1')
## 1. Introduction
尽管一些人脸识别的模型足够健壮，并且泛化能力很强，但是在非限制场景中仍然有跨年龄、跨模态、跨姿态以及遮挡等难题的存在。由于深度模型的泛化能力与训练集的规模相关性较高，如果训练集中正脸和侧脸图片的分布不均衡、侧脸不足，那么深度特征就更倾向于关注正脸，因此学习到的结果会偏向不完整的统计结论。可以通过数据增强的手段构建更大数据集来解决这一问题，一个常见方法是生成侧脸或者将一组图片作为一张输入，从而减轻侧脸数据的需求。另一个方法是合并更多的数据信息包括多任务学习以及模板适应。

我们观察到一个现象：正侧脸的差异是由头部旋转造成的，而这个原因不应该在侧脸识别中被忽视掉。但是在CNN中加入旋转矩阵比较困难，因为旋转矩阵在乘法下是closed，加法下则不是，而梯度下降的时候加法操作很多。受SLAM(simultaneous localization and mapping)中的姿态估计启发，开发了一个利用李代数来实现更新CNN中旋转矩阵的方法。
我们证明了每一个正侧脸样本对都由一次旋转操作联系在一起，它们对应的深度特征同样保留着对应的旋转关系。基于这一结论，提出李代数残差网络LARNet(Lie Algebra Residual Network)，实现了人脸旋转在特征空间的渲染，如果Figure 1所示。本文主要贡献：
1. 理论上证明了在使用李代数的残差网络中，正侧脸样本对的特征存在一种基于旋转的物理上的关系，而且相当于在CNN的特征空间上的一个额外的残差部分
2. 设计了一个新的门控子网络，既不需要修改已有backbone结构，也不依赖大量模块，但是能够带来较大的性能提升
3. LARNet增强了模型在特征表达和分类上的能力

## 2. Related Work
...

## 3. Methodology
首先假设正脸图像和其侧脸图像在原始的3D空间有对应的旋转关系。简单起见，只讨论正交关系的旋转。

### 3.1. Problem Formulation
目标是找到输入正脸图像和期望的侧脸图像的特征间的变换关系，以至于能在特征空间实现‘正面化’并获取一个对姿态变换鲁棒的特征表达，如Figure 1所示。
用F(x)代表CNN提取特征的函数，x代表输入图像。对x中的每一个像素(u,v)采用齐次坐标表示$(u,v,1)^T$, 为了方便起见，仍用x表示这些3维的齐次坐标

用d代表某一层的维度。则提取的特征$F(x)\in \mathbb{R}^d$. 需要证明存在一种映射$\mathcal{R}_{map}(\cdot):\mathbb{R}^d \rightarrow \mathbb{R}^d$可以作为图像空间旋转$\textbf{R}\in SO(3)$在特征空间中的等价:
$$
F(\textbf{R}\cdot x)=\mathcal{R}_{map}(F(x))
$$
对于正脸图像$x_f$和对应的侧脸图像$x_p$, 它们的单应性变换矩阵(homography transformation matrix)退化成一个旋转矩阵:$x_f=\textbf{R}\cdot x_p$，因此有：
$$
F(x_f)=F(\textbf{R}\cdot x_p)=\mathcal{R}_{map}(F(x_p))
$$
(上式的意思是在图片空间旋转后的人脸提特征等价于某种特征空间的变换)
进一步尝试使用李群理论证明映射$\mathcal{R}_{map}(\cdot)$可以分解成残差部分相加的形式，且仅由旋转确定：
$$
F(x_f)=F(x_p)+\omega (\textbf{R})\cdot \textbf{C}_{res}(\textbf{R},x_p)
$$
因此，只需要一个残差子网络$\textbf{C}_{res}$用于从输入的人脸图片中解码姿态变化信息，以及一个用于学习旋转量级的门控子网络$\omega$从而对特征学习过程的残差部分的强度实现控制。上面这个公式是LARNet的核心思想。

### 3.2. Rotation in Networks and Lie Algebra
