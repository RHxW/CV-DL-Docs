# MagFace
## Abstract
人脸识别系统的性能随着人脸多样性的增加而下降。先前的办法要么预先对人脸质量做处理，要么与人脸特征同时预测数据不确定性。本文提出一类loss称为MagFace，用于学习一个全局特征embedding，其大小可以用来衡量给定人脸的质量。在新loss下，可以证明特征embedding的大小与目标被成功识别的可能性呈正相关关系。而且，MagFace引入一种自适应机制来学习一种结构良好的类内特征分布，方法是通过将简单样本拉向类中心，将困难样本推离类中心。这样做能够防止模型对噪音低质量图片过拟合并且可以提升非限制场景人脸识别效果。
![Figure 1](1.png 'Figure 1')

## 1. Introduction
最近的置信度感知方法用来将每个人脸便是为隐空间的一个高斯分布，分布的均值估计了最接近的特征值，同时方差表示特征值的不确定性。尽管性能有所提升，但是这些方法会将人脸特征学习和数据噪音建模分离开。因此要引入额外的网络部分来计算每个图片的不确定性。这样做让训练过程变复杂了而且在推理中增加了计算量。而且不确定性的度量无法用传统方式对人脸特征进行度量。
本文引入学习全局和质量感知的人脸表示的方法，MagFace. MagFace的设计遵循了两条宗旨：
1. 给定一个人不同质量的图片，它会去学习一个类内分布，使高质量人脸图片与类中心的距离近，而低质量图片则分布在类边缘
2. 在替换现有推理架构时的成本应该尽可能小

为了达到上述目标，选择数值大小，这个与特征向量方向无关的属性，作为质量评估的指标。MagFace的核心目标是在增大类间距离的同时保持一个圆锥形的类内结构，如Figure 1b所示，其中不明确样本会被从类中心推开。这是通过在训练的时候给不明确样本适应性低权重并且在loss中对数值较大的特征给予奖励实现的。

## 2. Related Works
### 2.1. Face Recognition
### 2.2. Face Quality Assessment
### 2.3. Face Clustering

## 3. Methodology
