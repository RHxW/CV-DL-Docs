# RetinexNet

## Abstract
Retinex模型是用于低光照图像增强的有效工具。它假设观测图像可以分解为反射部分和光照部分。大多数机遇Retinex理论的方法都有经过仔细设计的人为约束和参数，因为这种分解本身是高度不适定的(highly ill-posed)，从而可能受限于多样化场景。本文收集了低光照数据集(LOL)，包含低光照和正常光照的数据对，并且提出一个深度Retinex-Net，由一个Decom-Net和一个Enhance-Net组成，分别对应分解和光照调整功能。在Decom-Net的训练过程中没有分解后的反射和光照的gt数据，这个网络仅通过关键约束进行学习，包括在不同光照图片对之间保持一致的反射信息，以及光照的平滑特性。在分解的基础之上，后续的光照增强操作使用一个增强网络，成为Enhance-Net，通过光照进行引导实现光照增强。

## 1. Introduction
有很多导致光照不足的原因，比如低光照环境、摄像设备的性能限制以及设备参数设置不合理等。低光照增强的目的就是为了发掘出隐藏在图片中的细节信息，提升视觉系统的性能。

已有的方法如histogram equalization及其变体通过抑制输入图像的直方图来实现某种约束，还有基于去雾的方法利用反转图像和原图间在光照不足和有雾环境下的关系实现增强。

另一种低光照增强的方法是基于Retinex理论，该理论假设观测到的彩色图片可以分解为反射部分和光照部分。Single-scale Retinex(SSR)方法使用高斯滤波器对光照图进行平滑约束，Multi-scale Retinex(MSRCR)利用多尺度高斯滤波器和色彩修复对SSR进行扩展。

这些方法虽然可以在某些场景下得到较好效果，但它们仍受限于模型的分解能力。因此，设计一个适用于多样化场景下分解的约束较为困难。而且分解后光照图的处理是手动进行的，性能依赖于参数的调整。

为了解决这些问题，提出一个数据驱动的Retinex分解方法，Retinex-Net是一个深度网络，它整合了图像分解和后续的增强操作。首先，使用一个子网络Decom-Net对图片进行分解，得到光照无关的反射部分和结构感知的平滑光照部分。这个Decom-Net通过两个约束进行学习，第一个是低光照和正常光照的图片对，它们的反射部分是一致的，第二个是光照图应该是平滑的，但同时应该保留主要的结构信息，通过一个结构感知的loss获取。然后用一个Enhance-Net来对光照图进行调整，目的是保持较大区域的光照一致性，同时对局部光照分布进行调整，通过多尺度拼接实现。